package pl.xt.jokii.db;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;

public class PostDevice {
	private String destUrl;
	private List<NameValuePair> parameters;
	
	/**
	 * Protected constructor
	 */
	PostDevice(){}	
	
	/**
	 * Protected constructor
	 * @param destUrl 		- destination url
	 */
	PostDevice(String destUrl)
	{
		this.destUrl 	= destUrl;
	}	
	
	/**
	 * Protected constructor
	 * @param destUrl 		- destination url
	 * @param parameters 	- list of pair of parameters <tag, value>
	 */
	PostDevice(String destUrl, List<NameValuePair> parameters)
	{
		this.destUrl 	= destUrl;
		this.parameters = parameters;
	}

	/**
	* Send data via POST
	* @param v - related View
	*/ 
	public void sendPostData(String s)
	{
		//final String url = "http://www.testeruploadu.w8w.pl/note/index.php?action=new";
		//Uri	uri	= Uri.parse("http://www.testeruploadu.w8w.pl/note/index.php?action=new");
	
		new Thread(new Runnable() 
		{
	
		public void run() 
		{
	
		try 
		{
			// If want make thi not inside thread uncomment two line below, but it's not good solution
			//StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
			//StrictMode.setThreadPolicy(policy);
		
			DefaultHttpClient httpClient = new DefaultHttpClient();
			HttpPost 		  httpPost   = new HttpPost(destUrl);
		
//			List<NameValuePair> parameters = new ArrayList<NameValuePair>(2);
		
//			parameters.add(new BasicNameValuePair("tekst", "a"));
//			parameters.add(new BasicNameValuePair("nots_add", "tak"));
//			parameters.add(new BasicNameValuePair("pas", "all"));	
		
			httpPost.setEntity(new UrlEncodedFormEntity(parameters, HTTP.UTF_8));
			httpClient.execute(httpPost);
		
		}
		catch (Exception e) 
		{
			throw new RuntimeException("Nie udana próba wys³ania danych za pomoc¹ POST", e);
		}	
	
		}
		}).start();
	
	}
}
